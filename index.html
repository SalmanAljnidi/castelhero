<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ø­Ø§Ø±Ø³ Ø§Ù„Ù‚Ù„Ø¹Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ© | Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø¬Ù†ÙŠØ¯ÙŠ</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2c3e50">
    <link rel="manifest" id="manifest-placeholder">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent-correct: #2ecc71;
            --accent-wrong: #e74c3c;
            --gold: #f1c40f;
            --bg-sky: #87CEEB;
            --bg-ground: #27ae60;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            font-family: 'Cairo', sans-serif;
            background-color: var(--primary);
            height: 100vh; height: 100dvh;
            overflow: hidden; touch-action: manipulation; user-select: none;
        }

        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 100; color: white; text-align: center; padding: 20px;
        }
        .hidden { display: none !important; }

        h1 {
            font-size: 2.2rem; margin: 0 0 15px 0; color: var(--gold);
            text-shadow: 3px 3px 0 rgba(0,0,0,0.3); font-weight: 800;
        }
        
        .credits-box {
            background: rgba(0,0,0,0.3); padding: 15px; border-radius: 20px;
            margin-bottom: 25px; width: 90%; max-width: 400px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .credits-name { font-size: 1.1rem; margin-bottom: 10px; color: #ecf0f1; font-weight: bold; }
        .social-icons { display: flex; justify-content: center; gap: 25px; }
        .social-icons a {
            color: white; font-size: 2.2rem; text-decoration: none;
            transition: transform 0.2s; display: inline-block;
        }
        .social-icons a:hover { transform: scale(1.2); }
        .fa-whatsapp { color: #25D366; }
        .fa-snapchat { color: #FFFC00; text-shadow: 0 0 2px #000; }

        .btn {
            background: var(--accent-correct); color: white; border: none;
            padding: 12px 30px; font-size: 1.2rem; border-radius: 50px;
            margin: 8px; cursor: pointer; font-family: 'Cairo', sans-serif;
            box-shadow: 0 5px 0 #219150; transition: all 0.1s; width: 90%; max-width: 350px; font-weight: bold;
        }
        .btn:active { transform: translateY(5px); box-shadow: none; }
        .btn-blue { background: #3498db; box-shadow: 0 5px 0 #2980b9; }
        .btn-gold { background: var(--gold); color: var(--primary); box-shadow: 0 5px 0 #c49f0c; }

        .mode-select { display: flex; gap: 10px; margin-bottom: 20px; width: 90%; max-width: 400px; }
        .mode-btn { flex: 1; padding: 10px; opacity: 0.6; transition: 0.3s; border: 3px solid transparent; font-size: 1rem; color: white; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; }
        .mode-btn.active { opacity: 1; border-color: var(--gold); background: rgba(255,255,255,0.2); transform: scale(1.05); }

        #game-container { display: flex; flex-direction: column; height: 100%; }
        #game-view {
            flex: 5; position: relative;
            background: linear-gradient(to bottom, var(--bg-sky) 60%, var(--bg-ground) 60%);
            overflow: hidden;
        }
        canvas { width: 100%; height: 100%; display: block; }

        #hud {
            position: absolute; top: 10px; left: 10px; right: 10px;
            display: flex; justify-content: space-between;
            font-size: 1.2rem; color: white; text-shadow: 1px 1px 2px #000;
            pointer-events: none; background: rgba(0,0,0,0.2); padding: 5px 10px; border-radius: 15px;
        }

        #controls-area {
            flex: 4; background: var(--secondary);
            padding: 10px 15px 30px 15px;
            display: flex; flex-direction: column; justify-content: center; gap: 10px;
            border-top: 5px solid var(--primary); box-shadow: 0 -5px 20px rgba(0,0,0,0.3); z-index: 10;
        }

        #question-box {
            background: white; color: var(--primary); padding: 10px; border-radius: 15px;
            text-align: center; font-size: 1.8rem; font-weight: 800;
            box-shadow: inset 0 -4px 0 rgba(0,0,0,0.1);
            min-height: 70px; display: flex; flex-direction: column; justify-content: center;
        }
        .visual-representation { display: flex; justify-content: center; gap: 4px; margin-top: 5px; flex-wrap: wrap; }
        .dot { width: 10px; height: 10px; background: var(--accent-wrong); border-radius: 50%; display: inline-block; box-shadow: 1px 1px 0 rgba(0,0,0,0.2); }

        #options-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; height: 80px; }
        .option-btn {
            background: white; color: var(--primary); border: none;
            font-size: 1.6rem; font-weight: bold; border-radius: 12px; cursor: pointer;
            box-shadow: 0 4px 0 #bdc3c7; transition: transform 0.1s; font-family: 'Cairo', sans-serif; height: 100%;
        }
        .option-btn:active { transform: translateY(4px); box-shadow: none; }
        .option-btn:disabled { cursor: not-allowed; opacity: 0.9; }
        
        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
            40%, 60% { transform: translate3d(6px, 0, 0); }
        }

        .shop-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; width: 100%; max-width: 400px; }
        .shop-item {
            background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px;
            border: 2px solid transparent; cursor: pointer; position: relative;
        }
        .shop-item.selected { border-color: var(--gold); background: rgba(241, 196, 15, 0.2); }
        .shop-item.locked { opacity: 0.5; filter: grayscale(1); }
        .shop-icon { font-size: 2.5rem; }
    </style>
</head>
<body>

    <div id="start-screen" class="screen">
        <h1>Ø­Ø§Ø±Ø³ Ø§Ù„Ù‚Ù„Ø¹Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©</h1>
        <div class="credits-box">
            <div class="credits-name">ÙÙƒØ±Ø© ÙˆØªØµÙ…ÙŠÙ…: Ø£. Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø¬Ù†ÙŠØ¯ÙŠ</div>
            <div class="social-icons">
                <a href="https://wa.me/966566996166" target="_blank"><i class="fab fa-whatsapp"></i></a>
                <a href="https://snapchat.com/t/2tVDWcXq" target="_blank"><i class="fab fa-snapchat"></i></a>
            </div>
        </div>
        <p style="margin: 0 0 10px 0; color: #ecf0f1;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:</p>
        <div class="mode-select">
            <button id="mode-lower" class="mode-btn active" onclick="setMode('lower')">Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø£ÙˆÙ„ÙŠØ©</button>
            <button id="mode-upper" class="mode-btn" onclick="setMode('upper')">Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¹Ù„ÙŠØ§</button>
        </div>
        <button class="btn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ! ğŸ®</button>
        <button class="btn btn-gold" onclick="showShop()">Ø§Ù„Ù…ØªØ¬Ø± ğŸ›’</button>
    </div>

    <div id="shop-screen" class="screen hidden">
        <h2 style="color:var(--gold)">Ø§Ø®ØªØ± Ø¨Ø·Ù„Ùƒ</h2>
        <p>Ø±ØµÙŠØ¯Ùƒ: <span class="arabic-num" id="shop-coins-disp">Ù </span> ğŸ’°</p>
        <div class="shop-grid" id="shop-items-container"></div>
        <button class="btn btn-blue" onclick="closeShop()">Ø¹ÙˆØ¯Ø©</button>
    </div>

    <div id="game-over-screen" class="screen hidden">
        <h1 style="color: var(--accent-wrong);">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©!</h1>
        <p style="font-size: 1.5rem;">Ø¬Ù…Ø¹Øª: <span class="arabic-num" id="final-score">Ù </span> Ù†Ù‚Ø·Ø©</p>
        <button class="btn" onclick="resetGame()">Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
        <button class="btn btn-blue" onclick="location.reload()">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>

    <div id="game-container" class="hidden">
        <div id="game-view">
            <canvas id="game-canvas"></canvas>
            <div id="hud">
                <div class="hud-item"><i class="fas fa-heart" style="color:#e74c3c"></i> <span class="arabic-num" id="lives-disp">Ù£</span></div>
                <div class="hud-item"><i class="fas fa-star" style="color:var(--gold)"></i> <span class="arabic-num" id="score-disp">Ù </span></div>
            </div>
        </div>
        <div id="controls-area">
            <div id="question-box">
                <div id="q-text">...</div>
                <div id="q-visual"></div>
            </div>
            <div id="options-grid">
                <button class="option-btn arabic-num" onclick="checkAnswer(this)"></button>
                <button class="option-btn arabic-num" onclick="checkAnswer(this)"></button>
                <button class="option-btn arabic-num" onclick="checkAnswer(this)"></button>
            </div>
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ«Ø¨ÙŠØª
        const manifestData = {
            "name": "Ø­Ø§Ø±Ø³ Ø§Ù„Ù‚Ù„Ø¹Ø©", "short_name": "Ø§Ù„Ù‚Ù„Ø¹Ø©", "start_url": ".",
            "display": "standalone", "background_color": "#2c3e50", "theme_color": "#2c3e50",
            "icons": [{"src": "https://cdn-icons-png.flaticon.com/512/3069/3069172.png", "sizes": "192x192", "type": "image/png"}]
        };
        const blob = new Blob([JSON.stringify(manifestData)], {type: 'application/json'});
        document.getElementById('manifest-placeholder').href = URL.createObjectURL(blob);

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        let gameMode = 'lower';
        let score = 0, lives = 3, coins = 0;
        let currentAnswer = 0;
        let gameState = 'start';
        let difficulty = 1;
        
        let savedData = JSON.parse(localStorage.getItem('mathHero_v4')) || { coins: 0, boughtSkins: ['ğŸ‘®â€â™‚ï¸'], currentSkin: 'ğŸ‘®â€â™‚ï¸' };
        coins = savedData.coins;

        const shopItems = [
            { icon: 'ğŸ‘®â€â™‚ï¸', price: 0 }, { icon: 'ğŸ¦¸â€â™‚ï¸', price: 50 },
            { icon: 'ğŸ¥·', price: 100 }, { icon: 'ğŸ¦', price: 200 },
            { icon: 'ğŸ¤–', price: 300 }, { icon: 'ğŸ§™â€â™‚ï¸', price: 500 }
        ];

        let hero = { x: 50, y: 0, sprite: savedData.currentSkin };
        let enemies = [];
        let particles = [];
        let lastSpawnTime = 0;
        let spawnInterval = 2500;
        let groundLevel = 0;

        function toArabicNum(num) {
            return num.toString().replace(/\d/g, d => 'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'[d]);
        }

        function resizeCanvas() {
            const container = document.getElementById('game-view');
            if(container) {
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                groundLevel = canvas.height * 0.6; 
                hero.y = groundLevel + 10;
            }
        }
        window.addEventListener('resize', resizeCanvas);

        function drawCastle() {
            const w = canvas.width * 0.25; 
            const h = canvas.height * 0.4; 
            const x = 0;
            const y = groundLevel - h + 20;

            ctx.fillStyle = '#7f8c8d'; 
            ctx.fillRect(x, y + 20, w * 0.3, h - 20);
            ctx.fillRect(x + w * 0.3, y - 20, w * 0.4, h + 20);
            
            ctx.fillStyle = '#95a5a6';
            ctx.fillRect(x, y + 10, w * 0.1, 10);
            ctx.fillRect(x + w * 0.2, y + 10, w * 0.1, 10);
            ctx.fillRect(x + w * 0.3, y - 30, w * 0.12, 10);
            ctx.fillRect(x + w * 0.58, y - 30, w * 0.12, 10);

            ctx.fillStyle = '#5d4037';
            ctx.beginPath();
            ctx.arc(x + w * 0.5, groundLevel + 20, w * 0.15, Math.PI, 0);
            ctx.fill();
            
            ctx.fillStyle = '#c0392b';
            ctx.beginPath();
            ctx.moveTo(x + w * 0.5, y - 60);
            ctx.lineTo(x + w * 0.5, y - 30);
            ctx.lineTo(x + w * 0.7, y - 45);
            ctx.fill();
            ctx.strokeStyle = '#2c3e50';
            ctx.beginPath();
            ctx.moveTo(x + w * 0.5, y - 30);
            ctx.lineTo(x + w * 0.5, y - 20);
            ctx.stroke();
        }

        function startGame() {
            gameState = 'playing';
            score = 0; lives = 3; difficulty = 1; spawnInterval = 2500;
            enemies = []; particles = [];
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-container').classList.remove('hidden');
            setTimeout(resizeCanvas, 100); 
            updateHUD();
            generateNewQuestion();
            gameLoop(0);
        }

        function updateHUD() {
            document.querySelectorAll('.arabic-num').forEach(el => {
                if(el.id.includes('score')) el.innerText = toArabicNum(score);
                if(el.id.includes('lives')) el.innerText = toArabicNum(lives);
                if(el.id.includes('coins')) el.innerText = toArabicNum(coins);
            });
            localStorage.setItem('mathHero_v4', JSON.stringify({ coins, boughtSkins: savedData.boughtSkins, currentSkin: savedData.currentSkin }));
        }

        function generateNewQuestion() {
            let n1, n2, op, vis = '';
            
            if (gameMode === 'lower') {
                if (Math.random() > 0.5) { // Ø¬Ù…Ø¹
                    n1 = Math.floor(Math.random() * 6);
                    n2 = Math.floor(Math.random() * (11 - n1));
                    currentAnswer = n1 + n2;
                    document.getElementById('q-text').innerText = `${toArabicNum(n1)} + ${toArabicNum(n2)} = ØŸ`;
                    vis = drawDots(n1) + '<span style="font-size:1.5rem">+</span>' + drawDots(n2);
                } else { // Ø·Ø±Ø­
                    n1 = Math.floor(Math.random() * 11);
                    n2 = Math.floor(Math.random() * (n1 + 1));
                    currentAnswer = n1 - n2;
                    document.getElementById('q-text').innerText = `${toArabicNum(n1)} âˆ’ ${toArabicNum(n2)} = ØŸ`;
                    vis = drawDots(n1);
                }
            } else {
                if (Math.random() > 0.5) { // Ø¶Ø±Ø¨
                    n1 = Math.floor(Math.random() * 11);
                    n2 = Math.floor(Math.random() * 11);
                    currentAnswer = n1 * n2;
                    document.getElementById('q-text').innerText = `${toArabicNum(n1)} Ã— ${toArabicNum(n2)} = ØŸ`;
                } else { // Ù‚Ø³Ù…Ø©
                    n2 = Math.floor(Math.random() * 9) + 1;
                    currentAnswer = Math.floor(Math.random() * 11);
                    n1 = n2 * currentAnswer;
                    document.getElementById('q-text').innerText = `${toArabicNum(n1)} Ã· ${toArabicNum(n2)} = ØŸ`;
                }
            }
            document.getElementById('q-visual').innerHTML = vis;
            
            let opts = [currentAnswer];
            while(opts.length < 3) {
                let r = currentAnswer + (Math.random() > 0.5 ? 1 : -1) * (Math.floor(Math.random()*5)+1);
                if(r >= 0 && !opts.includes(r)) opts.push(r);
            }
            opts.sort(() => Math.random() - 0.5);
            
            const btns = document.querySelectorAll('.option-btn');
            btns.forEach((b, i) => {
                b.innerText = toArabicNum(opts[i]);
                b.setAttribute('data-val', opts[i]); // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„Ø±Ù‚Ù…
                b.disabled = false;
                b.style.backgroundColor = 'white';
                b.style.color = 'var(--primary)';
            });
        }

        function drawDots(n) {
            if(gameMode === 'upper') return '';
            let s = ''; for(let i=0;i<n;i++) s+='<span class="dot"></span>';
            return `<div class="visual-representation">${s}</div>`;
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© ÙˆØ§Ù„Ù…Ø­Ù…ÙŠØ©
        function checkAnswer(btn) {
            try {
                // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ© ÙˆÙ„ÙŠØ³ Ù…Ù† Ø§Ù„Ù†Øµ
                let val = parseInt(btn.getAttribute('data-val'));
                
                const allBtns = document.querySelectorAll('.option-btn');
                allBtns.forEach(b => b.disabled = true);
                
                if(val === currentAnswer) {
                    btn.style.backgroundColor = '#2ecc71'; // Ø£Ø®Ø¶Ø±
                    btn.style.color = 'white';
                    score += 10; coins += 2;
                    if(enemies.length > 0) { 
                        createExplosion(enemies[0].x, enemies[0].y); 
                        enemies.shift(); 
                    }
                    updateHUD();
                    setTimeout(generateNewQuestion, 300);
                } else {
                    btn.style.backgroundColor = '#e74c3c'; // Ø£Ø­Ù…Ø±
                    btn.style.color = 'white';
                    document.getElementById('controls-area').classList.add('shake');
                    setTimeout(() => {
                        document.getElementById('controls-area').classList.remove('shake');
                        allBtns.forEach(b => { 
                            b.disabled = false; 
                            b.style.backgroundColor = 'white'; 
                            b.style.color = 'var(--primary)'; 
                        });
                    }, 500);
                }
            } catch (e) {
                console.error("Error in checkAnswer:", e);
                // ÙÙŠ Ø­Ø§Ù„ Ø­Ø¯ÙˆØ« Ø®Ø·Ø£ Ù†Ø¹ÙŠØ¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙˆØ±Ø§Ù‹
                document.querySelectorAll('.option-btn').forEach(b => b.disabled = false);
            }
        }

        function gameLoop(t) {
            if(gameState !== 'playing') return;
            ctx.clearRect(0,0,canvas.width,canvas.height);
            
            drawCastle();

            ctx.font = `${canvas.height * 0.15}px Cairo`;
            ctx.textAlign = 'center';
            ctx.fillText(hero.sprite, canvas.width * 0.15, groundLevel + 10);

            if(t - lastSpawnTime > spawnInterval) {
                let baseSpeed = 1.5; 
                let screenFactor = canvas.width > 800 ? 0.001 : 0.003; 
                
                enemies.push({
                    x: canvas.width + 50,
                    y: groundLevel + 10,
                    speed: (canvas.width * screenFactor + baseSpeed) * difficulty,
                    sprite: ['ğŸ‘¾','ğŸ‘º','ğŸ‘¹','ğŸ‰'][Math.floor(Math.random()*4)]
                });
                lastSpawnTime = t;
            }

            for(let i=enemies.length-1; i>=0; i--) {
                let e = enemies[i];
                e.x -= e.speed;
                ctx.fillText(e.sprite, e.x, e.y);
                if(e.x < canvas.width * 0.2) {
                    enemies.splice(i,1); lives--; updateHUD();
                    document.getElementById('game-view').classList.add('shake');
                    setTimeout(()=>document.getElementById('game-view').classList.remove('shake'), 400);
                    if(lives <= 0) {
                        gameState = 'over';
                        document.getElementById('game-container').classList.add('hidden');
                        document.getElementById('game-over-screen').classList.remove('hidden');
                    }
                }
            }

            for(let i=particles.length-1; i>=0; i--) {
                let p = particles[i];
                p.x += p.vx; p.y += p.vy; p.life -= 0.05;
                ctx.globalAlpha = p.life;
                ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, 5, 0, Math.PI*2); ctx.fill();
                if(p.life<=0) particles.splice(i,1);
            }
            ctx.globalAlpha = 1;

            requestAnimationFrame(gameLoop);
        }

        function createExplosion(x, y) {
            for(let i=0; i<20; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random()-0.5) * 10, vy: (Math.random()-0.5) * 10,
                    life: 1, color: `hsl(${Math.random()*360}, 100%, 50%)`
                });
            }
        }

        function renderShop() {
            const c = document.getElementById('shop-items-container'); c.innerHTML = '';
            shopItems.forEach(item => {
                let owned = savedData.boughtSkins.includes(item.icon);
                let div = document.createElement('div');
                div.className = `shop-item ${savedData.currentSkin === item.icon ? 'selected' : ''} ${!owned ? 'locked' : ''}`;
                div.innerHTML = `<div class="shop-icon">${item.icon}</div><div>${owned ? 'âœ”' : toArabicNum(item.price)}</div>`;
                div.onclick = () => {
                    if(owned) { savedData.currentSkin = item.icon; hero.sprite = item.icon; renderShop(); updateHUD(); }
                    else if(coins >= item.price) {
                        coins -= item.price; savedData.boughtSkins.push(item.icon);
                        savedData.currentSkin = item.icon; hero.sprite = item.icon;
                        renderShop(); updateHUD();
                    }
                }
                c.appendChild(div);
            });
        }
        function showShop() { document.getElementById('start-screen').classList.add('hidden'); document.getElementById('shop-screen').classList.remove('hidden'); renderShop(); }
        function closeShop() { document.getElementById('shop-screen').classList.add('hidden'); document.getElementById('start-screen').classList.remove('hidden'); }
        function setMode(m) { gameMode = m; document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active')); document.getElementById('mode-'+m).classList.add('active'); }
        function resetGame() { document.getElementById('game-over-screen').classList.add('hidden'); startGame(); }

    </script>
</body>
</html>
